<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Getting started &mdash; PyTango v7.1.0 documentation</title>
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '7.1.0',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="PyTango v7.1.0 documentation" href="index.html" />
    <link rel="next" title="The Tango Device Python API" href="client/index.html" />
    <link rel="prev" title="Welcome to PyTango 7.1 documentation!" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="client/index.html" title="The Tango Device Python API"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to PyTango 7.1 documentation!"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">PyTango v7.1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logo.png" alt="Logo"/>
            </a></p>
            <h3><a href="index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="">Getting started</a><ul>
<li><a class="reference external" href="#dependencies-on-other-libraries">Dependencies on other libraries</a></li>
<li><a class="reference external" href="#installing-precompiled-binaries">Installing precompiled binaries</a><ul>
<li><a class="reference external" href="#linux">Linux</a></li>
<li><a class="reference external" href="#windows">Windows</a></li>
</ul>
</li>
<li><a class="reference external" href="#compilation">Compilation</a><ul>
<li><a class="reference external" href="#id1">Linux</a><ul>
<li><a class="reference external" href="#boost-python-dependency">boost python dependency</a></li>
<li><a class="reference external" href="#configuration">configuration</a></li>
<li><a class="reference external" href="#build-install">build &amp; install</a></li>
<li><a class="reference external" href="#test">test</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference external" href="#a-quick-tour-of-client-binding-through-real-examples">A quick tour of client binding through real examples</a><ul>
<li><a class="reference external" href="#check-pytango-version">Check PyTango version</a></li>
<li><a class="reference external" href="#check-tango-c-version">Check Tango C++ version</a></li>
<li><a class="reference external" href="#test-the-connection-to-the-device-and-get-it-s-current-state">Test the connection to the Device and get it&#8217;s current state</a></li>
<li><a class="reference external" href="#execute-commands-with-scalar-arguments-on-a-device">Execute commands with scalar arguments on a Device</a></li>
<li><a class="reference external" href="#execute-commands-with-more-complex-types">Execute commands with more complex types</a></li>
<li><a class="reference external" href="#reading-and-writing-attributes">Reading and writing attributes</a></li>
<li><a class="reference external" href="#registering-devices">Registering devices</a></li>
<li><a class="reference external" href="#setting-up-device-properties">Setting up Device properties</a></li>
</ul>
</li>
<li><a class="reference external" href="#a-quick-tour-of-tango-device-server-binding-through-an-example">A quick tour of Tango device server binding through an example</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="index.html"
                                  title="previous chapter">Welcome to PyTango 7.1 documentation!</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="client/index.html"
                                  title="next chapter">The Tango Device Python API</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="_sources/start.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="getting-started">
<h1>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h1>
<div class="section" id="dependencies-on-other-libraries">
<h2>Dependencies on other libraries<a class="headerlink" href="#dependencies-on-other-libraries" title="Permalink to this headline">¶</a></h2>
<p>Current PyTango version has four major dependencies:</p>
<ul class="simple">
<li>python (&gt;= 2.4) (<a class="reference external" href="http://www.python.org/">http://www.python.org/</a>)</li>
<li>omniORB (<a class="reference external" href="http://omniorb.sourceforge.net/">http://omniorb.sourceforge.net/</a>)</li>
<li>Tango (&gt;= 7.1.0) (<a class="reference external" href="http://www.tango-controls.org/">http://www.tango-controls.org/</a>)
(really recommended 7.1.1)</li>
<li>boost python (<a class="reference external" href="http://www.boost.org">http://www.boost.org</a>):
if python &gt;= 2.6.3 then: boost-python &gt;= 1.41
else: boost-python &gt;= 1.33
We <strong>strongly</strong> recommend always using &gt;= 1.41</li>
</ul>
<p>plus one optional dependency (activated by default) on:</p>
<ul class="simple">
<li>numpy (&gt;= 1.1.0) (<a class="reference external" href="http://numpy.scipy.org/">http://numpy.scipy.org/</a>)</li>
</ul>
<p>For the provided windows binary, numpy is MANDATORY!</p>
</div>
<div class="section" id="installing-precompiled-binaries">
<h2>Installing precompiled binaries<a class="headerlink" href="#installing-precompiled-binaries" title="Permalink to this headline">¶</a></h2>
<p>The latest binaries for PyTango can be found at: <a class="reference external" href="http://www.tango-controls.org/download">http://www.tango-controls.org/download</a> under
the tango bindings section.</p>
<div class="section" id="linux">
<h3>Linux<a class="headerlink" href="#linux" title="Permalink to this headline">¶</a></h3>
<p>The PyTango team does <strong>not</strong> provide a precompiled binary for Linux since this
would mean having to provide 12 different binaries: one for each major python
version (2.4, 2.5, 2.6, 2.7, 3.0 and 3.1) times 2 for both 32bits and 64bits.</p>
</div>
<div class="section" id="windows">
<h3>Windows<a class="headerlink" href="#windows" title="Permalink to this headline">¶</a></h3>
<p>PyTango team provides a binary PyTango distributable for Windows XP/Vista 32bits
<strong>for usage with python 2.6</strong>.</p>
<p>The binary <strong>comes with its&#8217;s own boost-python, omniORB and Tango DLLs</strong></p>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="84%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">version</th>
<th class="head">Includes the following DLLs</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>7.1.0 rc1</td>
<td><ul class="first last simple">
<li>tango 7.1.1 (VC++ 8)</li>
<li>omniORB 4.1.4</li>
<li>boost python 1.41 beta 1 (VC++8, multi-threaded)
this version was used because it is the first version that
fixes a bug that prevents PyTango from being used with
python &gt;= 2.6.3</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The binary was compiled with numpy dependency therefore you need to have numpy*
installed in order to use numpy</p>
</div>
</div>
<div class="section" id="compilation">
<h2>Compilation<a class="headerlink" href="#compilation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3>Linux<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Since PyTango 7 the build system used to compile PyTango is the standard python
distutils.</p>
<p>Besides the binaries for the four dependencies mentioned above, you also need
the development files for the respective libraries.</p>
<div class="section" id="boost-python-dependency">
<h4>boost python dependency<a class="headerlink" href="#boost-python-dependency" title="Permalink to this headline">¶</a></h4>
<p>PyTango has a dependency on the boost python library (&gt;= 1.33). This means that
the shared library file <strong>libboost-python.so</strong> must be accessible to the
compilation command.</p>
<dl class="docutils">
<dt>Note:</dt>
<dd>If you use python &gt;= 2.6.3 you MUST install boost python &gt;= 1.40</dd>
</dl>
<p>Most linux distributions today provide a boost python package.</p>
<p>Furthermore, in order to be able to build PyTango, you also need the include headers of
boost python. They are normaly provided by a package called boost_python-dev.</p>
<dl class="docutils">
<dt>If, for some reason, you need to compile boost python, here is a quick recipie:</dt>
<dd><ul class="first last simple">
<li>Download latest boost tar.gz file and extract it</li>
<li>Download latest bjam (sourceforge provides a binary for many platforms)</li>
<li>put bjam accessible to the path</li>
<li>in the root directory where you extracted boost type: <cite>bjam &#8211;v2 &#8211;with-python toolset=gcc variant=release threading=multi link=shared</cite></li>
<li>this will produce in bin.v2/libs/python/build/gcc-&lt;gcc_version&gt;/release/threading-multi a file called <cite>libboost_python-gcc&lt;gcc_version&gt;-mt-&lt;boost_version&gt;.so.&lt;boost_python_version&gt;</cite></li>
</ul>
</dd>
</dl>
<p>Unfortunately the boost python shared library file often has a name
like : <cite>libboost_python-gcc43-mt-1_40.so.1.40.0</cite>.
Normal shared library installations contain a symbolic link which is a direct
or indirect link to the actual library file but which is a version independent
file name. However for boost python this is often not the case.
This means you have to manually create a symbolic link called <cite>libboost_python.so</cite> to the
actual library file.</p>
<p>So, assuming you have a <cite>libboost_python-gcc43-mt-1_40.so.1.40.0</cite> in <cite>/usr/lib</cite>:</p>
<div class="highlight-python"><pre>homer@moesbar:/usr/lib$ sudo ln -s libboost_python-gcc43-mt-1_40.so.1.40.0 libboost_python.so</pre>
</div>
<p>alternatively, you can edit the setup.py file that ships with PyTango and change
the lines:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></td><td class="code"><div class="highlight"><pre><span class="n">libraries</span> <span class="o">+=</span> <span class="p">[</span>
    <span class="s">&#39;boost_python&#39;</span><span class="p">,</span>
    <span class="s">&#39;pthread&#39;</span><span class="p">,</span>
    <span class="s">&#39;rt&#39;</span><span class="p">,</span>
    <span class="s">&#39;dl&#39;</span><span class="p">,</span>
    <span class="s">&#39;omniORB4&#39;</span><span class="p">,</span>
    <span class="s">&#39;omniDynamic4&#39;</span><span class="p">,</span>
    <span class="s">&#39;omnithread&#39;</span><span class="p">,</span>
    <span class="s">&#39;COS4&#39;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</td></tr></table></div>
<p>to:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></td><td class="code"><div class="highlight"><pre><span class="n">libraries</span> <span class="o">+=</span> <span class="p">[</span>
    <span class="s">&#39;boost_python-gcc43-mt-1_40.so.1.40.0&#39;</span><span class="p">,</span>
    <span class="s">&#39;pthread&#39;</span><span class="p">,</span>
    <span class="s">&#39;rt&#39;</span><span class="p">,</span>
    <span class="s">&#39;dl&#39;</span><span class="p">,</span>
    <span class="s">&#39;omniORB4&#39;</span><span class="p">,</span>
    <span class="s">&#39;omniDynamic4&#39;</span><span class="p">,</span>
    <span class="s">&#39;omnithread&#39;</span><span class="p">,</span>
    <span class="s">&#39;COS4&#39;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="configuration">
<h4>configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h4>
<p>The second step is to make sure the three/four libraries (omniORB, tango,
boost python and/or numpy) are accessible to the compilation command. So, for
example, if you installed:</p>
<blockquote>
<p><tt class="docutils literal"><span class="pre">boost</span> <span class="pre">python</span> <span class="pre">under</span> <span class="pre">/home/homer/local</span></tt></p>
<p><tt class="docutils literal"><span class="pre">omniORB</span> <span class="pre">under</span> <span class="pre">/home/homer/local1</span></tt></p>
<p><tt class="docutils literal"><span class="pre">tango</span> <span class="pre">under</span> <span class="pre">/home/homer/local2</span></tt></p>
<p><tt class="docutils literal"><span class="pre">numpy</span> <span class="pre">under</span> <span class="pre">/usr/lib/python2.6/site-packages/numpy</span></tt></p>
</blockquote>
<p>you must export the three environment variables:</p>
<div class="highlight-python"><pre>export BOOST_ROOT=/home/homer/local
export OMNI_ROOT=/home/homer/local1
export TANGO_ROOT=/home/homer/local2

# in openSuse 11.1 this is the default base location for the include files
export NUMPY_ROOT=/usr/lib/python2.6/site-packages/numpy/core</pre>
</div>
<p>(for numpy this is the default base location for the include files. This is
distribution dependent. For example, ubuntu places a numpy directory under /usr/include,
so exporting NUMPY_ROOT is not necessary for this distribution)</p>
<p>For the libraries that were installed in the default system directory (/usr or /usr/local)
the above lines are not necessary.</p>
</div>
<div class="section" id="build-install">
<h4>build &amp; install<a class="headerlink" href="#build-install" title="Permalink to this headline">¶</a></h4>
<p>Finally:</p>
<div class="highlight-python"><pre>python setup.py build
sudo python setup.py install</pre>
</div>
<p>Or if you whish to install in a different directory:</p>
<div class="highlight-python"><pre>python setup.py build
python setup.py install --prefix=/home/homer/local</pre>
</div>
<p>Or if you wish to use your own private python distribution:</p>
<div class="highlight-python"><pre>/home/homer/bin/python setup.py build
/home/homer/bin/python setup.py install</pre>
</div>
<p>For the last case above don&#8217;t forget that boost python should have also been
previously compiled with this private python distribution.</p>
</div>
<div class="section" id="test">
<h4>test<a class="headerlink" href="#test" title="Permalink to this headline">¶</a></h4>
<dl class="docutils">
<dt>To test the installation start a python console and type:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">import</span> <span class="nn">PyTango</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">PyTango</span><span class="o">.</span><span class="n">Release</span><span class="o">.</span><span class="n">version</span>
<span class="go">7.1.0</span>
</pre></div>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="section" id="a-quick-tour-of-client-binding-through-real-examples">
<h2>A quick tour of client binding through real examples<a class="headerlink" href="#a-quick-tour-of-client-binding-through-real-examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="check-pytango-version">
<h3>Check PyTango version<a class="headerlink" href="#check-pytango-version" title="Permalink to this headline">¶</a></h3>
<p>Start a python console and type:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><pre>1
2
3
4
5
6
7</pre></td><td class="code"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">import</span> <span class="nn">PyTango</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PyTango</span><span class="o">.</span><span class="n">__version__</span>
<span class="go">&#39;7.1.0&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PyTango</span><span class="o">.</span><span class="n">__version_number__</span>
<span class="go">710</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PyTango</span><span class="o">.</span><span class="n">__version_description__</span>
<span class="go">&#39;This version implements the C++ Tango 7.1 API.&#39;</span>
</pre></div>
</td></tr></table></div>
<p>or alternatively:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><pre>1
2
3
4
5
6
7</pre></td><td class="code"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">import</span> <span class="nn">PyTango</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PyTango</span><span class="o">.</span><span class="n">Release</span><span class="o">.</span><span class="n">version</span>
<span class="go">&#39;7.1.0&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PyTango</span><span class="o">.</span><span class="n">Release</span><span class="o">.</span><span class="n">version_number</span>
<span class="go">710</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PyTango</span><span class="o">.</span><span class="n">Release</span><span class="o">.</span><span class="n">version_description</span>
<span class="go">&#39;This version implements the C++ Tango 7.1 API.&#39;</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="check-tango-c-version">
<h3>Check Tango C++ version<a class="headerlink" href="#check-tango-c-version" title="Permalink to this headline">¶</a></h3>
<p>From a client (This is only possible since PyTango 7.0.0)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">import</span> <span class="nn">PyTango.constants</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PyTango</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">TgLibVers</span>
<span class="go">&#39;7.1.0&#39;</span>
</pre></div>
</div>
<p>From a server you can alternatively do:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">u</span> <span class="o">=</span> <span class="n">PyTango</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span>
<span class="n">tg_cpp_lib_ver</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">get_tango_lib_release</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="test-the-connection-to-the-device-and-get-it-s-current-state">
<h3>Test the connection to the Device and get it&#8217;s current state<a class="headerlink" href="#test-the-connection-to-the-device-and-get-it-s-current-state" title="Permalink to this headline">¶</a></h3>
<p>One of the most basic examples is to get a reference to a device and
determine if it is running or not:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33</pre></td><td class="code"><div class="highlight"><pre><span class="k">from</span> <span class="nn">PyTango</span> <span class="k">import</span> <span class="o">*</span>
<span class="k">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">time</span>

<span class="c"># Protect the script from Exceptions</span>
<span class="k">try</span><span class="p">:</span>
        <span class="c"># Get proxy on the tangotest1 device</span>
        <span class="k">print</span> <span class="s">&quot;Getting DeviceProxy &quot;</span>
        <span class="n">tangotest</span> <span class="o">=</span> <span class="n">DeviceProxy</span><span class="p">(</span><span class="s">&quot;tango/tangotest/1&quot;</span><span class="p">)</span>

        <span class="c"># ping it</span>
        <span class="k">print</span> <span class="n">tangotest</span><span class="o">.</span><span class="n">ping</span><span class="p">()</span>

        <span class="c"># get the state</span>
        <span class="k">print</span> <span class="n">tangotest</span><span class="o">.</span><span class="n">state</span><span class="p">()</span>

        <span class="c"># First use the classical command_inout way to execute the DevString command</span>
        <span class="c"># (DevString in this case is a command of the TangoTest device)</span>

        <span class="n">result</span><span class="o">=</span> <span class="n">tangotest</span><span class="o">.</span><span class="n">command_inout</span><span class="p">(</span><span class="s">&quot;DevString&quot;</span><span class="p">,</span> <span class="s">&quot;First hello to device&quot;</span><span class="p">)</span>
        <span class="k">print</span> <span class="s">&quot;Result of execution of DevString command=&quot;</span><span class="p">,</span> <span class="n">result</span>

        <span class="c"># the same with a Device specific command</span>
        <span class="n">result</span><span class="o">=</span> <span class="n">tangotest</span><span class="o">.</span><span class="n">DevString</span><span class="p">(</span><span class="s">&quot;Second Hello to device&quot;</span><span class="p">)</span>
        <span class="k">print</span> <span class="s">&quot;Result of execution of DevString command=&quot;</span><span class="p">,</span> <span class="n">result</span>

        <span class="c"># Please note that argin argument type is automagically managed by python</span>
        <span class="n">result</span><span class="o">=</span> <span class="n">tangotest</span><span class="o">.</span><span class="n">DevULong</span><span class="p">(</span><span class="mf">12456</span><span class="p">)</span>
        <span class="k">print</span> <span class="s">&quot;Result of execution of Status command=&quot;</span><span class="p">,</span> <span class="n">result</span>

<span class="c"># Catch Tango and Systems  Exceptions</span>
<span class="k">except</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&quot;Failed with exception !&quot;</span>
        <span class="k">print</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mf">0</span><span class="p">]</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="execute-commands-with-scalar-arguments-on-a-device">
<h3>Execute commands with scalar arguments on a Device<a class="headerlink" href="#execute-commands-with-scalar-arguments-on-a-device" title="Permalink to this headline">¶</a></h3>
<p>As you can see in the following example, when scalar types are used, the Tango
binding automagically manages the data types, and writing scripts is quite easy:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></td><td class="code"><div class="highlight"><pre><span class="k">from</span> <span class="nn">PyTango</span> <span class="k">import</span> <span class="o">*</span>
<span class="k">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">time</span>

<span class="n">tangotest</span> <span class="o">=</span> <span class="n">DeviceProxy</span><span class="p">(</span><span class="s">&quot;tango/tangotest/1&quot;</span><span class="p">)</span>

<span class="c"># First use the classical command_inout way to execute the DevString command</span>
<span class="c"># (DevString in this case is a command of the TangoTest device)</span>

<span class="n">result</span><span class="o">=</span> <span class="n">tangotest</span><span class="o">.</span><span class="n">command_inout</span><span class="p">(</span><span class="s">&quot;DevString&quot;</span><span class="p">,</span> <span class="s">&quot;First hello to device&quot;</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;Result of execution of DevString command=&quot;</span><span class="p">,</span> <span class="n">result</span>

<span class="c"># the same with a Device specific command</span>
<span class="n">result</span><span class="o">=</span> <span class="n">tangotest</span><span class="o">.</span><span class="n">DevString</span><span class="p">(</span><span class="s">&quot;Second Hello to device&quot;</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;Result of execution of DevString command=&quot;</span><span class="p">,</span> <span class="n">result</span>

<span class="c"># Please note that argin argument type is automagically managed by python</span>
<span class="n">result</span><span class="o">=</span> <span class="n">tangotest</span><span class="o">.</span><span class="n">DevULong</span><span class="p">(</span><span class="mf">12456</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;Result of execution of Status command=&quot;</span><span class="p">,</span> <span class="n">result</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="execute-commands-with-more-complex-types">
<h3>Execute commands with more complex types<a class="headerlink" href="#execute-commands-with-more-complex-types" title="Permalink to this headline">¶</a></h3>
<p>In this case you have to use put your arguments data in the correct python
structures:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></td><td class="code"><div class="highlight"><pre><span class="k">from</span> <span class="nn">PyTango</span> <span class="k">import</span> <span class="o">*</span>
<span class="k">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">time</span>

<span class="k">print</span> <span class="s">&quot;Getting DeviceProxy &quot;</span>
<span class="n">tango_test</span> <span class="o">=</span> <span class="n">DeviceProxy</span><span class="p">(</span><span class="s">&quot;tango/tangotest/1&quot;</span><span class="p">)</span>
<span class="c"># The input argument is a DevVarLongStringArray</span>
<span class="c"># so create the argin variable containing</span>
<span class="c"># an array of longs and an array of strings</span>
<span class="n">argin</span> <span class="o">=</span> <span class="p">([</span><span class="mf">1</span><span class="p">,</span><span class="mf">2</span><span class="p">,</span><span class="mf">3</span><span class="p">],</span> <span class="p">[</span><span class="s">&quot;Hello&quot;</span><span class="p">,</span> <span class="s">&quot;TangoTest device&quot;</span><span class="p">])</span>

<span class="n">result</span><span class="o">=</span> <span class="n">tango_test</span><span class="o">.</span><span class="n">DevVarLongArray</span><span class="p">(</span><span class="n">argin</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;Result of execution of DevVarLongArray command=&quot;</span><span class="p">,</span> <span class="n">result</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="reading-and-writing-attributes">
<h3>Reading and writing attributes<a class="headerlink" href="#reading-and-writing-attributes" title="Permalink to this headline">¶</a></h3>
<p>Basic read/write attribute operations:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></td><td class="code"><div class="highlight"><pre><span class="k">from</span> <span class="nn">PyTango</span> <span class="k">import</span> <span class="o">*</span>
<span class="k">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">time</span>

<span class="c">#Read a scalar attribute</span>
<span class="n">scalar</span><span class="o">=</span><span class="n">tangotest</span><span class="o">.</span><span class="n">read_attribute</span><span class="p">(</span><span class="s">&quot;long_scalar&quot;</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;attribute value&quot;</span><span class="p">,</span> <span class="n">scalar</span><span class="o">.</span><span class="n">value</span>
<span class="c">#Read a spectrum attribute</span>
<span class="n">spectrum</span><span class="o">=</span><span class="n">tangotest</span><span class="o">.</span><span class="n">read_attribute</span><span class="p">(</span><span class="s">&quot;double_spectrum&quot;</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;attribute value&quot;</span><span class="p">,</span> <span class="n">spectrum</span><span class="o">.</span><span class="n">value</span>

<span class="c"># Write a scalar attribute so use the scalar structure</span>
<span class="k">print</span> <span class="s">&quot;Writing attributes&quot;</span>

<span class="c"># Write a scalar attribute so use the scalar structure</span>
<span class="n">scalar</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mf">18</span>
<span class="k">print</span> <span class="s">&quot;attribute scalar  &quot;</span><span class="p">,</span> <span class="n">scalar</span>
<span class="k">print</span> <span class="s">&quot;Writing scalar attributes&quot;</span>
<span class="n">tangotest</span><span class="o">.</span><span class="n">write_attribute</span><span class="p">(</span><span class="n">scalar</span><span class="p">)</span>

<span class="c"># Write a scalar attribute so use the scalar structure</span>
<span class="n">spectrum</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">3.2</span><span class="p">,</span><span class="mf">12.3</span><span class="p">]</span>
<span class="k">print</span> <span class="s">&quot;attribute spectrum &quot;</span><span class="p">,</span> <span class="n">spectrum</span>
<span class="k">print</span> <span class="s">&quot;Writing spectrum attributes&quot;</span>
<span class="n">tangotest</span><span class="o">.</span><span class="n">write_attribute</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="registering-devices">
<h3>Registering devices<a class="headerlink" href="#registering-devices" title="Permalink to this headline">¶</a></h3>
<p>Defining devices in the Tango DataBase:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30</pre></td><td class="code"><div class="highlight"><pre><span class="k">from</span> <span class="nn">PyTango</span> <span class="k">import</span> <span class="o">*</span>
<span class="k">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">time</span>

<span class="c">#  A reference on the DataBase</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">Database</span><span class="p">()</span>

<span class="c"># The 3 devices name we want to create</span>
<span class="c"># Note: these 3 devices will be served by the same DServer</span>
<span class="n">new_device_name1</span><span class="o">=</span><span class="s">&quot;px1/tdl/mouse1&quot;</span>
<span class="n">new_device_name2</span><span class="o">=</span><span class="s">&quot;px1/tdl/mouse2&quot;</span>
<span class="n">new_device_name3</span><span class="o">=</span><span class="s">&quot;px1/tdl/mouse3&quot;</span>

<span class="c"># Define the Tango Class served by this  DServer</span>
<span class="n">new_device_info_mouse</span> <span class="o">=</span> <span class="n">DbDevInfo</span><span class="p">()</span>
<span class="n">new_device_info_mouse</span><span class="o">.</span><span class="n">_class</span> <span class="o">=</span> <span class="s">&quot;Mouse&quot;</span>
<span class="n">new_device_info_mouse</span><span class="o">.</span><span class="n">server</span> <span class="o">=</span> <span class="s">&quot;ds_Mouse/server_mouse&quot;</span>

<span class="c"># add the first device</span>
<span class="k">print</span> <span class="s">&quot;Creation Device:&quot;</span> <span class="p">,</span> <span class="n">new_device_name1</span>
<span class="n">new_device_info_mouse</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">new_device_name1</span>
<span class="n">db</span><span class="o">.</span><span class="n">add_device</span><span class="p">(</span><span class="n">new_device_info_mouse</span><span class="p">)</span>

<span class="c"># add the next device</span>
<span class="k">print</span> <span class="s">&quot;Creation Device:&quot;</span> <span class="p">,</span> <span class="n">new_device_name2</span>
<span class="n">new_device_info_mouse</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">new_device_name2</span>
<span class="n">db</span><span class="o">.</span><span class="n">add_device</span><span class="p">(</span><span class="n">new_device_info_mouse</span><span class="p">)</span>
<span class="c"># add the third device</span>
<span class="k">print</span> <span class="s">&quot;Creation Device:&quot;</span> <span class="p">,</span> <span class="n">new_device_name3</span>
<span class="n">new_device_info_mouse</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">new_device_name3</span>
<span class="n">db</span><span class="o">.</span><span class="n">add_device</span><span class="p">(</span><span class="n">new_device_info_mouse</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="setting-up-device-properties">
<h3>Setting up Device properties<a class="headerlink" href="#setting-up-device-properties" title="Permalink to this headline">¶</a></h3>
<p>A more complex example using python subtilities.
The following python script example (containing some functions and instructions
manipulating a Galil motor axis device server) gives an idea of how the Tango
API should be accessed from Python:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61</pre></td><td class="code"><div class="highlight"><pre><span class="k">from</span> <span class="nn">PyTango</span> <span class="k">import</span> <span class="o">*</span>
<span class="k">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">time</span>

<span class="c"># connecting to the motor axis device</span>
<span class="n">axis1</span> <span class="o">=</span> <span class="n">DeviceProxy</span> <span class="p">(</span><span class="s">&quot;microxas/motorisation/galilbox&quot;</span><span class="p">)</span>

<span class="c"># Getting Device Properties</span>
<span class="n">property_names</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;AxisBoxAttachement&quot;</span><span class="p">,</span>
                  <span class="s">&quot;AxisEncoderType&quot;</span><span class="p">,</span>
                  <span class="s">&quot;AxisNumber&quot;</span><span class="p">,</span>
                  <span class="s">&quot;CurrentAcceleration&quot;</span><span class="p">,</span>
                  <span class="s">&quot;CurrentAccuracy&quot;</span><span class="p">,</span>
                  <span class="s">&quot;CurrentBacklash&quot;</span><span class="p">,</span>
                  <span class="s">&quot;CurrentDeceleration&quot;</span><span class="p">,</span>
                  <span class="s">&quot;CurrentDirection&quot;</span><span class="p">,</span>
                  <span class="s">&quot;CurrentMotionAccuracy&quot;</span><span class="p">,</span>
                  <span class="s">&quot;CurrentOvershoot&quot;</span><span class="p">,</span>
                  <span class="s">&quot;CurrentRetry&quot;</span><span class="p">,</span>
                  <span class="s">&quot;CurrentScale&quot;</span><span class="p">,</span>
                  <span class="s">&quot;CurrentSpeed&quot;</span><span class="p">,</span>
                  <span class="s">&quot;CurrentVelocity&quot;</span><span class="p">,</span>
                  <span class="s">&quot;EncoderMotorRatio&quot;</span><span class="p">,</span>
                  <span class="s">&quot;logging_level&quot;</span><span class="p">,</span>
                  <span class="s">&quot;logging_target&quot;</span><span class="p">,</span>
                  <span class="s">&quot;UserEncoderRatio&quot;</span><span class="p">,</span>
                  <span class="s">&quot;UserOffset&quot;</span><span class="p">]</span>
<span class="n">axis_properties</span> <span class="o">=</span> <span class="n">axis1</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="n">property_names</span><span class="p">)</span>
<span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">axis_properties</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="k">print</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">axis_properties</span><span class="p">[</span><span class="n">prop</span><span class="p">][</span><span class="mf">0</span><span class="p">])</span>

<span class="c"># Changing Properties</span>
<span class="n">axis_properties</span><span class="p">[</span><span class="s">&quot;AxisBoxAttachement&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;microxas/motorisation/galilbox&quot;</span><span class="p">]</span>
<span class="n">axis_properties</span><span class="p">[</span><span class="s">&quot;AxisEncoderType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;1&quot;</span><span class="p">]</span>
<span class="n">axis_properties</span><span class="p">[</span><span class="s">&quot;AxisNumber&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;6&quot;</span><span class="p">]</span>
<span class="n">axis1</span><span class="o">.</span><span class="n">put_property</span><span class="p">(</span><span class="n">axis_properties</span><span class="p">)</span>

<span class="c"># Reading attributes and storing them in a python dictionary</span>
<span class="n">att_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">att_list</span> <span class="o">=</span> <span class="n">axis</span><span class="o">.</span><span class="n">get_attribute_list</span><span class="p">()</span>
<span class="k">for</span> <span class="n">att</span> <span class="ow">in</span> <span class="n">att_list</span><span class="p">:</span>
    <span class="n">att_val</span> <span class="o">=</span> <span class="n">axis</span><span class="o">.</span><span class="n">read_attribute</span><span class="p">(</span><span class="n">att</span><span class="p">)</span>
    <span class="k">print</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">att</span><span class="p">,</span><span class="n">att_val</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="n">att_dict</span><span class="p">[</span><span class="n">att</span><span class="p">]</span> <span class="o">=</span> <span class="n">att_val</span>

<span class="c"># Changing some attribute values</span>
<span class="n">attributes</span><span class="p">[</span><span class="s">&quot;AxisBackslash&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">axis1</span><span class="o">.</span><span class="n">write_attribute</span><span class="p">(</span><span class="n">attributes</span><span class="p">[</span><span class="s">&quot;AxisBackslash&quot;</span><span class="p">])</span>
<span class="n">attributes</span><span class="p">[</span><span class="s">&quot;AxisDirection&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">axis1</span><span class="o">.</span><span class="n">write_attribute</span><span class="p">(</span><span class="n">attributes</span><span class="p">[</span><span class="s">&quot;AxisDirection&quot;</span><span class="p">])</span>
<span class="n">attributes</span><span class="p">[</span><span class="s">&quot;AxisVelocity&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mf">1000.0</span>
<span class="n">axis1</span><span class="o">.</span><span class="n">write_attribute</span><span class="p">(</span><span class="n">attributes</span><span class="p">[</span><span class="s">&quot;AxisVelocity&quot;</span><span class="p">])</span>
<span class="n">attributes</span><span class="p">[</span><span class="s">&quot;AxisOvershoot&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mf">500.0</span>
<span class="n">axis1</span><span class="o">.</span><span class="n">write_attribute</span><span class="p">(</span><span class="n">attributes</span><span class="p">[</span><span class="s">&quot;AxisOvershoot&quot;</span><span class="p">])</span>

<span class="c"># Testing some device commands</span>
<span class="n">pos1</span><span class="o">=</span><span class="n">axis1</span><span class="o">.</span><span class="n">read_attribute</span><span class="p">(</span><span class="s">&quot;AxisCurrentPosition&quot;</span><span class="p">)</span>
<span class="n">axis1</span><span class="o">.</span><span class="n">command_inout</span><span class="p">(</span><span class="s">&quot;AxisBackward&quot;</span><span class="p">)</span>
<span class="k">while</span> <span class="n">pos1</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;</span> <span class="mf">1000.0</span><span class="p">:</span>
    <span class="n">pos1</span><span class="o">=</span><span class="n">axis1</span><span class="o">.</span><span class="n">read_attribute</span><span class="p">(</span><span class="s">&quot;AxisCurrentPosition&quot;</span><span class="p">)</span>
    <span class="k">print</span> <span class="s">&quot;position axis 1 = &quot;</span><span class="p">,</span><span class="n">pos1</span><span class="o">.</span><span class="n">value</span>
<span class="n">axis1</span><span class="o">.</span><span class="n">command_inout</span><span class="p">(</span><span class="s">&quot;AxisStop&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="a-quick-tour-of-tango-device-server-binding-through-an-example">
<h2>A quick tour of Tango device server binding through an example<a class="headerlink" href="#a-quick-tour-of-tango-device-server-binding-through-an-example" title="Permalink to this headline">¶</a></h2>
<p>To write a tango device server in python, you need to import two modules in your script which are:</p>
<ol class="arabic simple">
<li>The PyTango module</li>
<li>The python sys module provided in the classical python distribution</li>
</ol>
<p>The following in the python script for a Tango device server with two commands and two attributes. The commands are:</p>
<ol class="arabic simple">
<li>IOLOng which receives a Tango Long and return it multiply by 2. This command is allowed only if the device is in the ON state.</li>
<li>IOStringArray which receives an array of Tango strings and which returns it but in the reverse order. This command is only allowed if the device is in the ON state.</li>
</ol>
<p>The attributes are:</p>
<ol class="arabic simple">
<li>Long_attr wich is a Tango long attribute, Scalar and Read only with a minimum alarm set to 1000 and a maximum alarm set to 1500</li>
<li>Short_attr_rw which is a Tango short attribute, Scalar and Read/Write</li>
</ol>
<p>The following code is the complete device server code:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131</pre></td><td class="code"><div class="highlight"><pre><span class="k">import</span> <span class="nn">PyTango</span>
<span class="k">import</span> <span class="nn">sys</span>

<span class="k">class</span> <span class="nc">PyDsExp</span><span class="p">(</span><span class="n">PyTango</span><span class="o">.</span><span class="n">Device_3Impl</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">cl</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
        <span class="n">PyTango</span><span class="o">.</span><span class="n">Device_3Impl</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">cl</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug_stream</span><span class="p">(</span><span class="s">&#39;In PyDsExp __init__&#39;</span><span class="p">)</span>
        <span class="n">PyDsExp</span><span class="o">.</span><span class="n">init_device</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">init_device</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug_stream</span><span class="p">(</span><span class="s">&#39;In Python init_device method&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevState</span><span class="o">.</span><span class="n">ON</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attr_short_rw</span> <span class="o">=</span> <span class="mf">66</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attr_long</span> <span class="o">=</span> <span class="mf">1246</span>

<span class="c">#------------------------------------------------------------------</span>

    <span class="k">def</span> <span class="nf">delete_device</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug_stream</span><span class="p">(</span><span class="s">&#39;[delete_device] for device </span><span class="si">%s</span><span class="s"> &#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_name</span><span class="p">())</span>

<span class="c">#------------------------------------------------------------------</span>
<span class="c"># COMMANDS</span>
<span class="c">#------------------------------------------------------------------</span>

    <span class="k">def</span> <span class="nf">is_IOLong_allowed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_state</span><span class="p">()</span> <span class="o">==</span> <span class="n">PyTango</span><span class="o">.</span><span class="n">DevState</span><span class="o">.</span><span class="n">ON</span>

    <span class="k">def</span> <span class="nf">IOLong</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">in_data</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug_stream</span><span class="p">(</span><span class="s">&#39;[IOLong::execute] received number </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">in_data</span><span class="p">))</span>
        <span class="n">in_data</span> <span class="o">=</span> <span class="n">in_data</span> <span class="o">*</span> <span class="mf">2</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug_stream</span><span class="p">(</span><span class="s">&#39;[IOLong::execute] return number </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">in_data</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">in_data</span><span class="p">;</span>

<span class="c">#------------------------------------------------------------------</span>

    <span class="k">def</span> <span class="nf">is_IOStringArray_allowed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_state</span><span class="p">()</span> <span class="o">==</span> <span class="n">PyTango</span><span class="o">.</span><span class="n">DevState</span><span class="o">.</span><span class="n">ON</span>

    <span class="k">def</span> <span class="nf">IOStringArray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">in_data</span><span class="p">):</span>
        <span class="n">l</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">in_data</span><span class="p">)</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1</span><span class="p">);</span>
        <span class="n">out_index</span><span class="o">=</span><span class="mf">0</span>
        <span class="n">out_data</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">l</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">debug_stream</span><span class="p">(</span><span class="s">&#39;[IOStringArray::execute] received String&#39;</span> <span class="o">%</span> <span class="n">in_data</span><span class="p">[</span><span class="n">out_index</span><span class="p">])</span>
            <span class="n">out_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">in_data</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">debug_stream</span><span class="p">(</span><span class="s">&#39;[IOStringArray::execute] return String </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span><span class="n">out_data</span><span class="p">[</span><span class="n">out_index</span><span class="p">])</span>
            <span class="n">out_index</span> <span class="o">+=</span> <span class="mf">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">out_data</span>
        <span class="k">return</span> <span class="n">out_data</span>

<span class="c">#------------------------------------------------------------------</span>
<span class="c"># ATTRIBUTES</span>
<span class="c">#------------------------------------------------------------------</span>

    <span class="k">def</span> <span class="nf">read_attr_hardware</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug_stream</span><span class="p">(</span><span class="s">&#39;In read_attr_hardware&#39;</span><span class="p">)</span>

<span class="c">#------------------------------------------------------------------</span>

    <span class="k">def</span> <span class="nf">read_Long_attr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">the_att</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug_stream</span><span class="p">(</span><span class="s">&#39;[PyDsExp::read_attr] attribute name Long_attr&#39;</span><span class="p">)</span>

        <span class="c"># Before PyTango 7.0.0</span>
        <span class="c">#PyTango.set_attribute_value(the_att, self.attr_long)</span>

        <span class="c"># Now:</span>
        <span class="n">the_att</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attr_long</span><span class="p">)</span>

<span class="c">#------------------------------------------------------------------</span>

    <span class="k">def</span> <span class="nf">read_Short_attr_rw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">the_att</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug_stream</span><span class="p">(</span><span class="s">&#39;[PyDsExp::read_attr] attribute name Short_attr_rw&#39;</span><span class="p">)</span>

        <span class="c"># Before PyTango 7.0.0</span>
        <span class="c">#PyTango.set_attribute_value(the_att, self.attr_short_rw)</span>

        <span class="c"># Now:</span>
        <span class="n">the_att</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attr_short_rw</span><span class="p">)</span>

<span class="c">#------------------------------------------------------------------</span>

    <span class="k">def</span> <span class="nf">write_Short_attr_rw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">the_att</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug_stream</span><span class="p">(</span><span class="s">&#39;In write_Short_attr_rw for attribute </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">the_att</span><span class="o">.</span><span class="n">get_name</span><span class="p">())</span>

        <span class="c"># Before PyTango 7.0.0</span>
        <span class="c">#data = []</span>
        <span class="c">#PyTango.get_write_value(the_att, data)</span>

        <span class="c"># Now:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">the_att</span><span class="o">.</span><span class="n">get_write_value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attr_short_rw</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span>

<span class="c">#------------------------------------------------------------------</span>
<span class="c"># CLASS</span>
<span class="c">#------------------------------------------------------------------</span>

<span class="k">class</span> <span class="nc">PyDsExpClass</span><span class="p">(</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DeviceClass</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">PyTango</span><span class="o">.</span><span class="n">DeviceClass</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_type</span><span class="p">(</span><span class="s">&quot;TestDevice&quot;</span><span class="p">)</span>
        <span class="k">print</span> <span class="s">&#39;In PyDsExpClass __init__&#39;</span>

    <span class="n">cmd_list</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&#39;IOLong&#39;</span> <span class="p">:</span> <span class="p">[</span> <span class="p">[</span> <span class="n">PyTango</span><span class="o">.</span><span class="n">ArgType</span><span class="o">.</span><span class="n">DevLong</span><span class="p">,</span> <span class="s">&quot;Number&quot;</span> <span class="p">],</span>
                              <span class="p">[</span> <span class="n">PyTango</span><span class="o">.</span><span class="n">ArgType</span><span class="o">.</span><span class="n">DevLong</span><span class="p">,</span> <span class="s">&quot;Number * 2&quot;</span> <span class="p">]</span> <span class="p">],</span>
                 <span class="s">&#39;IOStringArray&#39;</span> <span class="p">:</span> <span class="p">[</span> <span class="p">[</span> <span class="n">PyTango</span><span class="o">.</span><span class="n">ArgType</span><span class="o">.</span><span class="n">DevVarStringArray</span><span class="p">,</span> <span class="s">&quot;Array of string&quot;</span> <span class="p">],</span>
                                     <span class="p">[</span> <span class="n">PyTango</span><span class="o">.</span><span class="n">ArgType</span><span class="o">.</span><span class="n">DevVarStringArray</span><span class="p">,</span> <span class="s">&quot;This reversed array&quot;</span><span class="p">]</span> <span class="p">],</span>
    <span class="p">}</span>

    <span class="n">attr_list</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&#39;Long_attr&#39;</span> <span class="p">:</span> <span class="p">[</span> <span class="p">[</span> <span class="n">PyTango</span><span class="o">.</span><span class="n">ArgType</span><span class="o">.</span><span class="n">DevLong</span> <span class="p">,</span>
                                    <span class="n">PyTango</span><span class="o">.</span><span class="n">AttrDataFormat</span><span class="o">.</span><span class="n">SCALAR</span> <span class="p">,</span>
                                    <span class="n">PyTango</span><span class="o">.</span><span class="n">AttrWriteType</span><span class="o">.</span><span class="n">READ</span><span class="p">],</span>
                                  <span class="p">{</span> <span class="s">&#39;min alarm&#39;</span> <span class="p">:</span> <span class="mf">1000</span><span class="p">,</span> <span class="s">&#39;max alarm&#39;</span> <span class="p">:</span> <span class="mf">1500</span> <span class="p">}</span> <span class="p">],</span>

                 <span class="s">&#39;Short_attr_rw&#39;</span> <span class="p">:</span> <span class="p">[</span> <span class="p">[</span> <span class="n">PyTango</span><span class="o">.</span><span class="n">ArgType</span><span class="o">.</span><span class="n">DevShort</span><span class="p">,</span>
                                       <span class="n">PyTango</span><span class="o">.</span><span class="n">AttrDataFormat</span><span class="o">.</span><span class="n">SCALAR</span><span class="p">,</span>
                                       <span class="n">PyTango</span><span class="o">.</span><span class="n">AttrWriteType</span><span class="o">.</span><span class="n">READ_WRITE</span> <span class="p">]</span> <span class="p">]</span>
    <span class="p">}</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">py</span> <span class="o">=</span> <span class="n">PyTango</span><span class="o">.</span><span class="n">Util</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
        <span class="n">py</span><span class="o">.</span><span class="n">add_TgClass</span><span class="p">(</span><span class="n">PyDsExpClass</span><span class="p">,</span> <span class="n">PyDsExp</span><span class="p">,</span> <span class="s">&#39;PyDsExp&#39;</span><span class="p">)</span>
        <span class="n">U</span> <span class="o">=</span> <span class="n">PyTango</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span>
        <span class="n">U</span><span class="o">.</span><span class="n">server_init</span><span class="p">()</span>
        <span class="n">U</span><span class="o">.</span><span class="n">server_run</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">PyTango</span><span class="o">.</span><span class="n">DevFailed</span><span class="p">,</span><span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&#39;-------&gt; Received a DevFailed exception:&#39;</span><span class="p">,</span><span class="n">e</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span><span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&#39;-------&gt; An unforeseen exception occured....&#39;</span><span class="p">,</span><span class="n">e</span>
</pre></div>
</td></tr></table></div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="client/index.html" title="The Tango Device Python API"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to PyTango 7.1 documentation!"
             >previous</a> |</li>
        <li><a href="index.html">PyTango v7.1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2009, ALBA - CELLS.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.2.
    </div>
  </body>
</html>